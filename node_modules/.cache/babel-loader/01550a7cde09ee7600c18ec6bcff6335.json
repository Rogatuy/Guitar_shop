{"ast":null,"code":"import _slicedToArray from\"C:\\\\HTMLacademy\\\\League_A\\\\Greyd\\\\Guitar_shop\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import{useEffect,useState}from'react';import{Link}from'react-router-dom';import{useNavigate,useParams}from'react-router-dom';import Footer from'../../components/footer/footer';import Header from'../../components/header/header';import Icons from'../../components/icons/icons';import LoadingScreen from'../../components/loading-screen/loading-screen';import RatingStars from'../../components/rating-stars/rating-stars';import{AppRoute,COMMENTS_STEP}from'../../const';import{useAppDispatch,useAppSelector}from'../../hooks';import{fetchCommentsAction,fetchFullGuitarAction}from'../../store/api-actions';import{getCommentsList,getCommentsLoadedDataStatus}from'../../store/comments-data/selectors';import{getGuitarFull,getGuitarFullLoadedDataStatus}from'../../store/guitar-full-data/selectors';import{getSortComment,scrollOnTop}from'../../utils';import CommentGuitar from'./components/comment-guitar/comment-guitar';import Tabs from'./components/tabs/tabs';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function GuitarFull(){var guitarFull=useAppSelector(getGuitarFull);var isDataLoadedGuitarFull=useAppSelector(getGuitarFullLoadedDataStatus);var comments=useAppSelector(getCommentsList);var isDataLoadedCommentsList=useAppSelector(getCommentsLoadedDataStatus);var _useState=useState(COMMENTS_STEP),_useState2=_slicedToArray(_useState,2),commentsCount=_useState2[0],setCommentsCount=_useState2[1];var sortComment=getSortComment(comments);var _useParams=useParams(),id=_useParams.id;var guitarId=Number(id);var dispatch=useAppDispatch();var navigate=useNavigate();useEffect(function(){if(guitarFull.id===0||(guitarFull===null||guitarFull===void 0?void 0:guitarFull.id)!==guitarId){dispatch(fetchFullGuitarAction(guitarId));dispatch(fetchCommentsAction(guitarId));}},[guitarId,dispatch,guitarFull,navigate]);if(guitarFull.id===0){if(!isDataLoadedGuitarFull||!isDataLoadedCommentsList){return/*#__PURE__*/_jsx(LoadingScreen,{});}}if(guitarFull.id===0&&isDataLoadedGuitarFull&&isDataLoadedCommentsList){navigate(AppRoute.NoFoundScreen);}var handleButtonClick=function handleButtonClick(){setCommentsCount(commentsCount+Math.min(COMMENTS_STEP,comments.length));};return/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",children:[/*#__PURE__*/_jsx(Icons,{}),/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"main\",{className:\"page-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-content__title title title--bigger\",children:guitarFull.name}),/*#__PURE__*/_jsxs(\"ul\",{className:\"breadcrumbs page-content__breadcrumbs\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumbs__item\",children:/*#__PURE__*/_jsx(Link,{className:\"link\",to:'/#',children:\"\\u0413\\u043B\\u0430\\u0432\\u043D\\u0430\\u044F\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumbs__item\",children:/*#__PURE__*/_jsx(Link,{className:\"link\",to:\"\".concat(AppRoute.Main,\"page_1\"),children:\"\\u041A\\u0430\\u0442\\u0430\\u043B\\u043E\\u0433\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumbs__item\",children:/*#__PURE__*/_jsx(Link,{className:\"link\",to:'/#',children:guitarFull.name})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-container\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"product-container__img\",src:\"../\".concat(guitarFull.previewImg),width:\"90\",height:\"235\",alt:guitarFull.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-container__info-wrapper\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"product-container__title title title--big title--uppercase\",children:guitarFull.name}),/*#__PURE__*/_jsx(RatingStars,{rating:guitarFull.rating}),/*#__PURE__*/_jsx(Tabs,{guitar:guitarFull})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-container__price-wrapper\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"product-container__price-info product-container__price-info--title\",children:\"\\u0426\\u0435\\u043D\\u0430:\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"product-container__price-info product-container__price-info--value\",children:[guitarFull.price,\" \\u20BD\"]}),/*#__PURE__*/_jsx(Link,{className:\"button button--red button--big product-container__button\",to:'/#',children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0432 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0443\"})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"reviews\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"reviews__title title title--bigger\",children:\"\\u041E\\u0442\\u0437\\u044B\\u0432\\u044B\"}),/*#__PURE__*/_jsx(Link,{className:\"button button--red-border button--big reviews__sumbit-button\",to:\"#\",children:\"\\u041E\\u0441\\u0442\\u0430\\u0432\\u0438\\u0442\\u044C \\u043E\\u0442\\u0437\\u044B\\u0432\"}),sortComment.slice(0,commentsCount).map(function(commentGuitar){return/*#__PURE__*/_jsx(CommentGuitar,{comment:commentGuitar},commentGuitar.id);}),sortComment.length>commentsCount&&/*#__PURE__*/_jsx(\"button\",{className:\"button button--medium reviews__more-button\",onClick:handleButtonClick,children:\"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u0435\\u0449\\u0435 \\u043E\\u0442\\u0437\\u044B\\u0432\\u044B\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button button--up button--red-border button--big reviews__up-button\",onClick:scrollOnTop,children:\"\\u041D\\u0430\\u0432\\u0435\\u0440\\u0445\"})]})]})}),/*#__PURE__*/_jsx(Footer,{})]});}export default GuitarFull;","map":{"version":3,"sources":["C:/HTMLacademy/League_A/Greyd/Guitar_shop/src/pages/guitar-full/guitar-full.tsx"],"names":["useEffect","useState","Link","useNavigate","useParams","Footer","Header","Icons","LoadingScreen","RatingStars","AppRoute","COMMENTS_STEP","useAppDispatch","useAppSelector","fetchCommentsAction","fetchFullGuitarAction","getCommentsList","getCommentsLoadedDataStatus","getGuitarFull","getGuitarFullLoadedDataStatus","getSortComment","scrollOnTop","CommentGuitar","Tabs","GuitarFull","guitarFull","isDataLoadedGuitarFull","comments","isDataLoadedCommentsList","commentsCount","setCommentsCount","sortComment","id","guitarId","Number","dispatch","navigate","NoFoundScreen","handleButtonClick","Math","min","length","name","Main","previewImg","rating","price","slice","map","commentGuitar"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport Footer from '../../components/footer/footer';\r\nimport Header from '../../components/header/header';\r\nimport Icons from '../../components/icons/icons';\r\nimport LoadingScreen from '../../components/loading-screen/loading-screen';\r\nimport RatingStars from '../../components/rating-stars/rating-stars';\r\nimport { AppRoute, COMMENTS_STEP } from '../../const';\r\nimport { useAppDispatch, useAppSelector } from '../../hooks';\r\nimport { fetchCommentsAction, fetchFullGuitarAction } from '../../store/api-actions';\r\nimport { getCommentsList, getCommentsLoadedDataStatus } from '../../store/comments-data/selectors';\r\nimport { getGuitarFull, getGuitarFullLoadedDataStatus } from '../../store/guitar-full-data/selectors';\r\nimport { getSortComment, scrollOnTop } from '../../utils';\r\nimport CommentGuitar from './components/comment-guitar/comment-guitar';\r\nimport Tabs from './components/tabs/tabs';\r\n\r\nfunction GuitarFull (): JSX.Element {\r\n  const guitarFull = useAppSelector(getGuitarFull);\r\n  const isDataLoadedGuitarFull = useAppSelector(getGuitarFullLoadedDataStatus);\r\n\r\n  const comments = useAppSelector(getCommentsList);\r\n  const isDataLoadedCommentsList = useAppSelector(getCommentsLoadedDataStatus);\r\n  const [commentsCount, setCommentsCount] = useState<number>(COMMENTS_STEP);\r\n  const sortComment = getSortComment(comments);\r\n\r\n\r\n  const {id} = useParams();\r\n  const guitarId = Number(id);\r\n\r\n  const dispatch = useAppDispatch();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n\r\n    if (guitarFull.id === 0 || guitarFull?.id !== guitarId) {\r\n      dispatch(fetchFullGuitarAction(guitarId));\r\n      dispatch(fetchCommentsAction(guitarId));\r\n\r\n    }}, [guitarId, dispatch, guitarFull, navigate]);\r\n\r\n  if (guitarFull.id === 0)  {\r\n    if ( !isDataLoadedGuitarFull || !isDataLoadedCommentsList ) {\r\n      return (\r\n        <LoadingScreen />\r\n      );\r\n    }\r\n  }\r\n\r\n  if (guitarFull.id === 0 && isDataLoadedGuitarFull && isDataLoadedCommentsList) {\r\n    navigate(AppRoute.NoFoundScreen);\r\n  }\r\n\r\n  const handleButtonClick = () => {\r\n    setCommentsCount(commentsCount + Math.min(COMMENTS_STEP, comments.length));\r\n  };\r\n\r\n  return (\r\n    <div className=\"wrapper\">\r\n      <Icons/>\r\n      <Header />\r\n      <main className=\"page-content\">\r\n        <div className=\"container\">\r\n          <h1 className=\"page-content__title title title--bigger\">{guitarFull.name}</h1>\r\n          <ul className=\"breadcrumbs page-content__breadcrumbs\">\r\n            <li className=\"breadcrumbs__item\">\r\n              <Link className=\"link\" to={'/#'}>Главная</Link>\r\n            </li>\r\n            <li className=\"breadcrumbs__item\">\r\n              <Link className=\"link\" to={`${AppRoute.Main}page_1`}>Каталог</Link>\r\n            </li>\r\n            <li className=\"breadcrumbs__item\">\r\n              <Link className=\"link\" to={'/#'}>{guitarFull.name}</Link>\r\n            </li>\r\n          </ul>\r\n          <div className=\"product-container\">\r\n            <img className=\"product-container__img\" src={`../${guitarFull.previewImg}`} width=\"90\" height=\"235\" alt={guitarFull.name} />\r\n            <div className=\"product-container__info-wrapper\">\r\n              <h2 className=\"product-container__title title title--big title--uppercase\">{guitarFull.name}</h2>\r\n              <RatingStars\r\n                rating = {guitarFull.rating}\r\n              />\r\n              <Tabs guitar={guitarFull}/>\r\n            </div>\r\n            <div className=\"product-container__price-wrapper\">\r\n              <p className=\"product-container__price-info product-container__price-info--title\">Цена:</p>\r\n              <p className=\"product-container__price-info product-container__price-info--value\">{guitarFull.price} ₽</p>\r\n              <Link  className=\"button button--red button--big product-container__button\" to={'/#'}>Добавить в корзину</Link>\r\n            </div>\r\n          </div>\r\n          <section className=\"reviews\">\r\n            <h3 className=\"reviews__title title title--bigger\">Отзывы</h3>\r\n            <Link className=\"button button--red-border button--big reviews__sumbit-button\" to=\"#\">Оставить отзыв</Link>\r\n            {sortComment.slice(0, commentsCount).map((commentGuitar) => (\r\n              <CommentGuitar\r\n                key={commentGuitar.id}\r\n                comment={commentGuitar}\r\n              />\r\n            ))}\r\n            {sortComment.length > commentsCount &&\r\n            <button className=\"button button--medium reviews__more-button\" onClick={handleButtonClick}>Показать еще отзывы</button>}\r\n            <button className=\"button button--up button--red-border button--big reviews__up-button\" onClick={scrollOnTop}>Наверх</button>\r\n          </section>\r\n        </div>\r\n      </main>\r\n      <Footer/>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default GuitarFull;\r\n"]},"metadata":{},"sourceType":"module"}