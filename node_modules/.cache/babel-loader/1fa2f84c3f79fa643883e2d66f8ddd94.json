{"ast":null,"code":"import { createAsyncThunk } from '@reduxjs/toolkit';\nimport { api, store } from '.';\nimport { APIRoute } from '../const';\nimport { errorHandle } from '../services/error-handle';\nimport { loadComments, toggleLoaderComments } from './comments-data/comments-data';\nimport { loadGuitarFull, toggleLoaderGuitarFull } from './guitar-full-data/guitar-full-data';\nimport { loadGuitars } from './guitars-data/guitars-data';\nimport { reviewSendStatus } from './review-send-status/review-send-status';\nexport const fetchGuitarsAction = createAsyncThunk('data/fetchGuitars', async () => {\n  try {\n    const {\n      data\n    } = await api.get(APIRoute.Guitars);\n    store.dispatch(loadGuitars(data));\n  } catch (error) {\n    errorHandle(error);\n  }\n});\nexport const fetchFullGuitarAction = createAsyncThunk('data/fetchFullGuitar', async id => {\n  try {\n    const {\n      data\n    } = await api.get(`${APIRoute.FullGuitar}/${id}`);\n    store.dispatch(loadGuitarFull(data));\n  } catch (error) {\n    errorHandle(error);\n    store.dispatch(toggleLoaderGuitarFull());\n  }\n});\nexport const fetchCommentsAction = createAsyncThunk('data/fetchComments', async id => {\n  try {\n    const {\n      data\n    } = await api.get(`${APIRoute.FullGuitar}/${id}/comments`);\n    store.dispatch(loadComments(data));\n  } catch (error) {\n    errorHandle(error);\n    store.dispatch(toggleLoaderComments(true));\n  }\n});\nexport const addComment = createAsyncThunk('data/addComment', async _ref => {\n  let {\n    guitarId,\n    userName,\n    advantage,\n    disadvantage,\n    comment,\n    rating\n  } = _ref;\n\n  try {\n    store.dispatch(reviewSendStatus('sending'));\n    await api.post(`${APIRoute.Comments}/${guitarId}`, {\n      guitarId,\n      userName,\n      advantage,\n      disadvantage,\n      comment,\n      rating\n    });\n    store.dispatch(postUserReview({\n      guitarId,\n      userName,\n      advantage,\n      disadvantage,\n      comment,\n      rating\n    }));\n    store.dispatch(reviewSendStatus('initial'));\n  } catch (error) {\n    errorHandle(error);\n    store.dispatch(reviewSendStatus('error'));\n  }\n});","map":{"version":3,"sources":["C:/HTMLacademy/League_A/Greyd/Guitar_shop/src/store/api-actions.ts"],"names":["createAsyncThunk","api","store","APIRoute","errorHandle","loadComments","toggleLoaderComments","loadGuitarFull","toggleLoaderGuitarFull","loadGuitars","reviewSendStatus","fetchGuitarsAction","data","get","Guitars","dispatch","error","fetchFullGuitarAction","id","FullGuitar","fetchCommentsAction","addComment","guitarId","userName","advantage","disadvantage","comment","rating","post","Comments","postUserReview"],"mappings":"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","sourcesContent":["import { createAsyncThunk } from '@reduxjs/toolkit';\r\nimport { api, store } from '.';\r\nimport { APIRoute } from '../const';\r\nimport { errorHandle } from '../services/error-handle';\r\nimport { Comments } from '../types/comments';\r\nimport { Guitar, Guitars } from '../types/guitar';\r\nimport { loadComments, toggleLoaderComments } from './comments-data/comments-data';\r\nimport { loadGuitarFull, toggleLoaderGuitarFull } from './guitar-full-data/guitar-full-data';\r\nimport { loadGuitars } from './guitars-data/guitars-data';\r\nimport { reviewSendStatus } from './review-send-status/review-send-status';\r\n\r\n\r\nexport const fetchGuitarsAction = createAsyncThunk(\r\n  'data/fetchGuitars',\r\n  async () => {\r\n    try {\r\n      const {data} = await api.get<Guitars>(APIRoute.Guitars);\r\n      store.dispatch(loadGuitars(data));\r\n    } catch(error) {\r\n      errorHandle(error);\r\n    }\r\n  },\r\n);\r\n\r\nexport const fetchFullGuitarAction = createAsyncThunk(\r\n  'data/fetchFullGuitar',\r\n  async (id: number) => {\r\n    try {\r\n      const {data} = await api.get<Guitar>(`${APIRoute.FullGuitar}/${id}`);\r\n      store.dispatch(loadGuitarFull(data));\r\n    } catch (error) {\r\n      errorHandle(error);\r\n      store.dispatch(toggleLoaderGuitarFull());\r\n    }\r\n  },\r\n);\r\n\r\nexport const fetchCommentsAction = createAsyncThunk(\r\n  'data/fetchComments',\r\n  async (id: number | null) => {\r\n    try {\r\n      const {data} = await api.get<Comments>(`${APIRoute.FullGuitar}/${id}/comments`);\r\n      store.dispatch(loadComments(data));\r\n    } catch (error) {\r\n      errorHandle (error);\r\n      store.dispatch(toggleLoaderComments(true));\r\n    }\r\n  },\r\n);\r\n\r\n\r\nexport type CommentPost = {\r\n  guitarId: number,\r\n  userName: string,\r\n  advantage: string,\r\n  disadvantage: string,\r\n  comment: string,\r\n  rating: number,\r\n};\r\n\r\n\r\nexport const addComment = createAsyncThunk(\r\n  'data/addComment',\r\n  async ({guitarId, userName, advantage, disadvantage, comment, rating}:CommentPost) => {\r\n    try {\r\n      store.dispatch(reviewSendStatus('sending'));\r\n      await api.post<CommentPost>(`${APIRoute.Comments}/${guitarId}`, {guitarId, userName, advantage, disadvantage, comment, rating});\r\n      store.dispatch(postUserReview({guitarId, userName, advantage, disadvantage, comment, rating}));\r\n      store.dispatch(reviewSendStatus('initial'));\r\n    } catch (error) {\r\n      errorHandle (error);\r\n      store.dispatch(reviewSendStatus('error'));\r\n    }\r\n  },\r\n);\r\n"]},"metadata":{},"sourceType":"module"}